<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <!-- Despacho -->
<record id="dispatch_guide_view_tree" model="ir.ui.view">
	<field name="name">dispatch.guide.tree</field>
	<field name="model">dispatch.guide</field>
	<field name="arch" type="xml">
		<tree>
			<field name="name" string="Number"/>
			<field name="driver"/>
			<field name="date" />
			<field name="state"/>
		</tree>
	</field>
</record>

<record id="dispatch_guide_view_form" model="ir.ui.view">
	<field name="name">dispatch.guide.form</field>
	<field name="model">dispatch.guide</field>
	<field name="arch" type="xml">
		<form string="Despacho">
			<header>
				<button name="action_done" string="Validar" type="object" class="btn-primary" states="draft"/>
				<button name="action_draft" string="Convertir a borrador" type="object" states="done"/>
				<button name="action_add_lines" string="Add lines" type="object" class="btn-primary oe_edit_only" states="draft"/>
				<field name="state" widget="statusbar"/>
			</header>
			<sheet>
				<div class="oe_title">
					<label for="name" class="oe_edit_only"/>
					<h1><field name="name" required="1"/></h1>
				</div>
				<group>
					<group name="left">
						<field name="driver" attrs="{'readonly':[('state','=','done')]}"/>
						<!-- <field name="driver" attrs="{'readonly':[('state','=','done')]}" domain="[('is_driver','=','True')]" options="{'no_open':True, 'no_create': True}"/> -->
						<field name="identification_driver" attrs="{'readonly':[('state','=','done')]}"/>
						<field name="dispatch_type" attrs="{'readonly':[('state','=','done')]}"/>
					</group>
					<group name="right">
						<field name="date"/>
						<field name="vehicle_brand" attrs="{'readonly':[('state','=','done')]}"/>
						<field name="vehicle_model" attrs="{'readonly':[('state','=','done')]}"/>
						<field name="vehicle_colour" attrs="{'readonly':[('state','=','done')]}"/>
						<field name="vehicle_plate" attrs="{'readonly':[('state','=','done')]}"/>
					</group>
				</group>
				<notebook>
					<page string="Lines" name="page_detail">
						<field name="dispatch_lines_ids" nolabel="1"  attrs="{'readonly':[('state','=','done')]}">
							<tree editable="bottom">
								<field name="sale_order_id" options="{'no_open': True,'no_create': True, 'no_create_edit':True}"/>
								<field name="partner"/>
								<field name="shipping_address"/>
								<field name="phone"/>
								<!-- <field name="package" sum="Total Package"/>
								<field name="zone"/> -->
							</tree>
						</field>
					</page>
				</notebook>
				<group>
					<field name="notes" attrs="{'readonly':[('state','=','done')]}"/>
				</group>
			</sheet>
		</form>
	</field>
</record>

<record id="dispatch_guide_view_search" model="ir.ui.view">
	<field name="name">dispatch.guide.search</field>
	<field name="model">dispatch.guide</field>
	<field name="arch" type="xml">
		<search string="Filter Despacho">
			<field name="name"/>
			<filter string="Done" name="filter_done" domain="[('state','=','done')]"/>
			<filter string="Draft" name="filter_draft" domain="[('state','=','draft')]"/>
			<filter string="State" name="groupby_state" context="{'group_by': 'state'}"/>
		</search>
	</field>
  </record>

<record id="dispatch_guide_action" model="ir.actions.act_window">
	<field name="name">Dispatch guide</field>
	<field name="res_model">dispatch.guide</field>
	<field name="view_mode">tree,form</field>
	<field name="help" type="html">
		<p class="o_view_nocontent_smiling_face">Clic en "Crear" para agregar un nuevo Despacho</p>
		<p>Agregue despachos</p>
	</field>
</record>

<record id="dispatch_line_view_form" model="ir.ui.view">
	<field name="name">dispatch.line.form</field>
	<field name="model">dispatch.guide.line</field>
	<field name="arch" type="xml">
		<form>
			<sheet>
				<group>
					<group name="left">
						<field name="sale_order_id" context="{'edit': False,'create': False}"/>
						<field name="partner"/>
						<field name="shipping_address"/>
					</group>
					<group name="right">
						<field name="phone"/>
						<!-- <field name="package"/>
						<field name="zone"/> -->
					</group>
				</group>
			</sheet>
		</form>
	</field>
</record>

<menuitem
	id="dispatch_guide_menu"
	name="Dispatch guide"
	parent="stock.menu_stock_warehouse_mgmt"
	action="dispatch_guide_action"
	sequence="40"/>
</odoo>
